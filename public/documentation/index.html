<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <title>Sleep Tracker API - Documentation</title>

        <link rel="stylesheet" href="/css/styles.css" />
    </head>

    <body>
        <header>
            <div>
                <h2>Sleep Tracker</h2>
                
                <nav>
                    <a href="/">Home</a>
                    <a href="/about">About</a>
                    <a href="/documentation">Documentation</a>
                </nav>

            </div>  
        </header>

        <section id = "documentation">
            <div class = "content-nav">
                <div>
                    <h3>Contents</h3> 
                    <a href = "#intro">Introduction</a>
                    <hr>
                    <a href = "#schema">
                        Schema
                        <ul>
                            <li><a href = "#users-schema">Users</a></li>
                            <li><a href = "#entries-schema">Entries</a></li>
                        </ul>
                    </a>
                    <hr>
                    <a href = "#api-endpoints">
                        API Endpoints
                        <ul>
                            <li><a href = "#auth">Authentication</a></li>
                            <li><a href = "#restricted-endpoints">
                                Restricted Endpoints
                                <ul>
                                    <li><a href = "#users-endpoints">Users</a></li>
                                    <li><a href = "#entries-endpoints">Sleep Entries</a></li>
                                </ul>
                            </a></li>
                        </ul>
                    </a>
                </div>
                
            </div>

            <hr>

            <div class = "content">
                <h3>This api is made to work with the sleep tracker app project built by a team consisting 
                    of UI/UX Web, React FrontEnd, and Backend developers</h3>
                
                <br />

                <h2 id = "intro">Introduction</h2>
                <p>
                    This api will provide the resources necessary on the React App to log in, out, and display data for users to use. The complete project is built in a two week period where the team collaborates to get all essential items connected to each other to make one app for the user.
                </p>

                <h3>Make sure to add a .env file with at least the following:</h3>
                <code>
                    PORT=5000 <br />
                    NODE_ENV=development <br />
                    DATABASE_URL=postgres://postgres:<postgres_password>@localhost:5432/<database_name_in_postgres> <br />

                    JWT_SECRET=your secret here... you can convert it to any type of hash online if you like <br />
                </code>

                <p>
                    Convert Secret or anything to hash -> <a href = "http://www.md5hashgenerator.com">Click Here!</a>

                    <ul>
                        <li>This will convert the secret to an MD5 Hash string</li>
                        <li>You can use any hash generator online, just Google Hash Generator</li>
                    </ul>
                </p>

                <br />
                <hr>
                <br />

                <h2 id = "schema">Schema</h2>

                <h3 id = "users-schema">Users</h3>
                <table>
                    <tr>
                        <th>Field</th>
                        <th>Data Type</th>
                    </tr>
                    <tr>
                        <td>id</td>
                        <td>Primary Key - Int - Generated By Database</td>
                    </tr>
                    <tr>
                        <td>fname</td>
                        <td>String - Required</td>
                    </tr>
                    <tr>
                        <td>lname</td>
                        <td>String - Required</td>
                    </tr>
                    <tr>
                        <td>email</td>
                        <td>String - Required - Unique</td>
                    </tr>
                    <tr>
                        <td>username</td>
                        <td>String - Required - Unique</td>
                    </tr>
                    <tr>
                        <td>password</td>
                        <td>String - Required - Hashed/Encrypted upon signup</td>
                    </tr>
                </table>

                <h3 id = "entries-schema">Entries</h3>
                <table>
                    <tr>
                        <th>Field</th>
                        <th>Data Type</th>
                    </tr>
                    <tr>
                        <td>id</td>
                        <td>Primary Key - Int - Generated By Database</td>
                    </tr>
                    <tr>
                        <td>sleep_start</td>
                        <td>Datetime - Required</td>
                    </tr>
                    <tr>
                        <td>sleep_end</td>
                        <td>Datetime</td>
                    </tr>
                    <tr>
                        <td>daytime_mood</td>
                        <td>Integer - Range between 1 - 4</td>
                    </tr>
                    <tr>
                        <td>sleep_start_mood</td>
                        <td>Integer - Range between 1 - 4</td>
                    </tr>
                    <tr>
                        <td>sleep_end_mood</td>
                        <td>Integer - Range between 1 - 4</td>
                    </tr>
                    <tr>
                        <td>sleep_time_total</td>
                        <td>Time - Will auto generate when both start and end times are provided</td>
                    </tr>
                    <tr>
                        <td>user_id</td>
                        <td>Integer - Required - Must be the logged on user id</td>
                    </tr>
                </table>
                <p>
                    The mood values will automatically get set within range if outside the 1 - 4 range. If value is > 4 it will be changed to 4, if < 1 it will be set to 1.
                </p>

                <br />
                <hr>
                <br />

                <h1 id = "api-endpoints">API Endpoints</h1>

                <h3>Base URL: https://webpt15-sleep-tracker-api.herokuapp.com</h3>
                <p>Most endpoints receive and return JSON</p>
                <br />

                <h3 id = "auth">Authentication</h3>
                <table>
                    <tr>
                        <th>Method</th>
                        <th>URL</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>POST</td>
                        <td>/api/auth/register</td>
                        <td>Creates a user. Requires First Name, Last Name, Email, Username, and Password. Returns the user id, username, and a token.</td>
                    </tr>
                    <tr>
                        <td>POST</td>
                        <td>/api/auth/login</td>
                        <td>Logs user in taking the username and password provided. Returns User Id, Username, and Token.</td>
                    </tr>
                </table>

                <h5>POST /api/auth/register</h5>
                <h4>Receives</h4>
                <code>
                    {
                        <ul>
                            <li>"fname": "Test",</li>
                            <li>"lname": "Tester",</li>
                            <li>"email": "tester@testing.com",</li>
                            <li>"username": "tester",</li>
                            <li>"password": "test123"</li>
                        </ul>
                    }
                </code>

                <h4>Returns</h4>
                <code>
                    {
                        <ul>
                            <li>"user_id": 1,</li>
                            <li>"username": "tester",</li>
                            <li>"token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NSwibmFtZSI6IkFsaWNlIiwiZW1haWwiOiJhbGljZUBnbWFpbC5jb20iLCJyb2xlcyI6WyJTVFVERU5UIl0sImlhdCI6MTU5MjYxODM4MiwiZXhwIjoxNTkyNjI1NTgyfQ.JCn_0iOCptEmJ7xIKBf4tOPHZanncar719n0mGdHiI8"</li>
                        </ul>
                    }
                </code>
                <br />

                <h5>POST /api/auth/login</h5>
                <h4>Receives</h4>
                <code>
                    {
                        <ul>
                            <li>"username": "tester",</li>
                            <li>"password": "test123"</li>
                        </ul>
                    }
                </code>

                <h4>Returns</h4>
                <code>
                    {
                        <ul>
                            <li>"user_id": 1,</li>
                            <li>"username": "tester",</li>
                            <li>"token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NSwibmFtZSI6IkFsaWNlIiwiZW1haWwiOiJhbGljZUBnbWFpbC5jb20iLCJyb2xlcyI6WyJTVFVERU5UIl0sImlhdCI6MTU5MjYxODM4MiwiZXhwIjoxNTkyNjI1NTgyfQ.JCn_0iOCptEmJ7xIKBf4tOPHZanncar719n0mGdHiI8"</li>
                        </ul>
                    }
                </code>

                <br /><br />
                <hr>
                <br /><br />

                <h2 id = "restricted-endpoints">Restricted Endpoints (Require Token)</h2>

                <p>
                    Using Authentication Token for the endpoints beyond this point. Make sure to add the keyword Bearer with the token in the Authorization header.
                    <br /><br />
                    For Example:
                </p>
                <code>
                    // If creating an axiosWithAuth file <br />
                    axios.create({
                        <ul>
                            <li>headers: {
                                <ul>
                                    <li>Authorization: `Bearer ${token}`,</li>
                                </ul>
                            },</li>
                        </ul>
                    });
                    <br /><br />
                    // If adding the authorization on the axios call <br />
                    axios.get("https://webpt15-sleep-tracker-api.herokuapp.com/api/users", {headers: {Authorization: `Bearer ${token}` } });
                </code>

                <p>
                    Either way you use the token, just be sure to add "Bearer" before the token separated by a space.
                </p>

                <br /><br />

                <h3 id = "users-endpoints">Users</h3>
                <table>
                    <tr>
                        <th>Method</th>
                        <th>URL</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>GET</td>
                        <td>/api/users/:id</td>
                        <td>Returns profile info for user by id</td>
                    </tr>
                    <tr>
                        <td>PUT</td>
                        <td>/api/users/:id</td>
                        <td>Updates user info for user by id. Users can only update their own data</td>
                    </tr>
                    <tr>
                        <td>DELETE</td>
                        <td>/api/users/:id</td>
                        <td>Deletes user for user by id. Users can only delete their own account</td>
                    </tr>
                </table>

                <h5>GET /api/users/:id</h5>
                <h4>Returns</h4>
                <code>
                    {
                        <ul>
                            <li>"id": 1</li>
                            <li>"fname": "Test",</li>
                            <li>"lname": "Tester",</li>
                            <li>"email": "tester@testing.com",</li>
                            <li>"username": "tester",</li>
                        </ul>
                    }
                </code>

                <br />

                <h5>PUT /api/users/:id</h5>
                <h4>Receives (fields that do not change can be ommitted)</h4>
                <code>
                    {
                        <ul>
                            <li>"id": 1</li>
                            <li>"fname": "Test",</li>
                            <li>"lname": "Tester",</li>
                            <li>"email": "tester@testing.com",</li>
                            <li>"username": "tester",</li>
                            <li>"password": "test123"</li>
                        </ul>
                    }
                </code>

                <h4>Returns</h4>
                <code>
                    {
                        <ul>
                            <li>"id": 1</li>
                            <li>"fname": "Test",</li>
                            <li>"lname": "Tester",</li>
                            <li>"email": "tester@testing.com",</li>
                            <li>"username": "tester",</li>
                        </ul>
                    }
                </code>

                <br />

                <h5>DELETE /api/users/:id</h5>
                <p>Does not receive or return JSON</p>
                <h4>Returns </h4>
                <code>
                    Status 204 No Content
                </code>
                
                <br /><br />
                <hr>
                <br /><br />
                

                <h3 id = "entries-endpoints">Sleep Entries</h3>
                <table>
                    <tr>
                        <th>Method</th>
                        <th>URL</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>GET</td>
                        <td>/api/sleep</td>
                        <td>Returns an array of sleep entries for the logged on user.</td>
                    </tr>
                    <tr>
                        <td>GET</td>
                        <td>/api/sleep/:id</td>
                        <td>Returns the sleep entry by id for the logged on user.</td>
                    </tr>
                    <tr>
                        <td>POST</td>
                        <td>/api/sleep</td>
                        <td>Creates new sleep entry for logged on user. Requires sleep start time and user id</td>
                    </tr>
                    <tr>
                        <td>PUT</td>
                        <td>/api/sleep/:id</td>
                        <td>Updates sleep entry by id for logged on user. Just provide the properties being changed</td>
                    </tr>
                    <tr>
                        <td>DELETE</td>
                        <td>/api/sleep/:id</td>
                        <td>Deletes sleep entry by id for logged on user.</td>
                    </tr>
                </table>

                <h5>GET /api/sleep</h5>
                <h4>Returns</h4>
                <code>
                    [
                        <ul>
                            <li>{
                                <ul>
                                    <li>"id": 1</li>
                                    <li>"sleep_start": 1597869337330,</li>
                                    <li>"sleep_end": null,</li>
                                    <li>"daytime_mood": 3,</li>
                                    <li>"sleep_start_mood": 1,</li>
                                    <li>"sleep_end_mood": null,</li>
                                    <li>"sleep_time_total": null,</li>
                                    <li>"user_id": 1</li>
                                </ul>
                            },
                            </li>
                        </ul>
                        <ul>
                            <li>{
                                <ul>
                                    <li>"id": 2</li>
                                    <li>"sleep_start": 1597869337330,</li>
                                    <li>"sleep_end": 1597869337330,</li>
                                    <li>"daytime_mood": 3,</li>
                                    <li>"sleep_start_mood": 1,</li>
                                    <li>"sleep_end_mood": 3,</li>
                                    <li>"sleep_time_total": 3,</li>
                                    <li>"user_id": 1</li>
                                </ul>
                            },
                            </li>
                        </ul>

                    ]
                </code>

                <h5>GET /api/sleep/:id</h5>
                <h4>Returns</h4>
                <code>
                    {
                        <ul>
                            <li>"id": 1</li>
                            <li>"sleep_start": 1597869337330,</li>
                            <li>"sleep_end": null,</li>
                            <li>"daytime_mood": 3,</li>
                            <li>"sleep_start_mood": 1,</li>
                            <li>"sleep_end_mood": null,</li>
                            <li>"sleep_time_total": null,</li>
                            <li>"user_id": 1</li>
                        </ul>
                    }
                </code>

                <br />

                <h5>POST /api/sleep</h5>
                <h4>Receives</h4>
                <code>
                    {
                        <ul>
                            <li>"sleep_start": 1597869337330,</li>
                            <li>"user_id": 1</li>
                        </ul>
                    }
                </code>
                <p>You may add any other property if have a value for them, otherwise, only sleep_start and user_id are required</p>

                <h4>Returns</h4>
                <code>
                    {
                        <ul>
                            <li>"id": 1</li>
                            <li>"sleep_start": 1597869337330,</li>
                            <li>"sleep_end": null,</li>
                            <li>"daytime_mood": 3,</li>
                            <li>"sleep_start_mood": 1,</li>
                            <li>"sleep_end_mood": null,</li>
                            <li>"sleep_time_total": null,</li>
                            <li>"user_id": 1</li>
                        </ul>
                    }
                </code>

                <br />

                <h5>PUT /api/sleep/:id</h5>
                <h4>Receives (fields that do not change can be ommitted)</h4>
                <code>
                    {
                        <ul>
                            <li>"id": 1</li>
                            <li>"sleep_start": 1597869337330,</li>
                            <li>"sleep_end": null,</li>
                            <li>"daytime_mood": 3,</li>
                            <li>"sleep_start_mood": 1,</li>
                            <li>"sleep_end_mood": null,</li>
                            <li>"sleep_time_total": null,</li>
                            <li>"user_id": 1</li>
                        </ul>
                    }
                </code>

                <h4>Returns</h4>
                <code>
                    {
                        <ul>
                            <li>"id": 1</li>
                            <li>"sleep_start": 1597869337330,</li>
                            <li>"sleep_end": 1597869337330,</li>
                            <li>"daytime_mood": 3,</li>
                            <li>"sleep_start_mood": 1,</li>
                            <li>"sleep_end_mood": 3,</li>
                            <li>"sleep_time_total": 3,</li>
                            <li>"user_id": 1</li>
                        </ul>
                    }
                </code>

                <br />

                <h5>DELETE /api/sleep/:id</h5>
                <p>Does not receive or return JSON</p>
                <h4>Returns </h4>
                <code>
                    Status 204 No Content
                </code>
                
                <br /><br />
                <hr>
                <br /><br />


            </div>
        </section>

        <footer>
            <p>
                &copy; Copyright 2020, Carlos "Mannie" Alvarez-Berrios, Lambda School Build Week Project.
            </p>
        </footer>
    </body>

</html>